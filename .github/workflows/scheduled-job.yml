name: Scheduled Job - Call Backend API

on:
  schedule:
    - cron: '*/5 * * * *'  # ⏱ Every 5 minutes (UTC)
  workflow_dispatch:       # 🔘 Allow manual trigger from GitHub UI

jobs:
  ping_backend:
    runs-on: ubuntu-latest

    steps:
      - name: 🔔 Call /users endpoint
        run: |
          curl -s https://sy2wqvdvwe.us-east-1.awsapprunner.com/users
      - name: 📣 Send Slack message
        run: |
          curl -X POST -H 'Content-type: application/json' \
          --data "{\"text\":\"✅ Scheduled Job Ran at $(date '+%Y-%m-%d %H:%M:%S')\"}" \
          ${{ secrets.SLACK_WEBHOOK_URL }}

